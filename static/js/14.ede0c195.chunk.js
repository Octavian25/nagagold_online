(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1126:function(a,e,t){"use strict";t.r(e);var n=t(0),s=t.n(n),i=t(9),l=t(16),r=t(14),o=t(27),c=t.n(o),d=t(7),u=t(57),m=t(2),b=t(39),p=t(4),g=t(11),h=t(6),_=t(290),k=t(291),f=t(5),j=t(18),E=t(725),O=t(15),S=t.n(O);class B extends n.Component{constructor(a){super(a),this.state={isloadingFaktur:!1,isLoading:!1,isLoadingBatal:!1,date:new Date}}getBarcode(a){clearTimeout(this.delay),this.delay=setTimeout(()=>{this.setState({isloadingFaktur:!0}),Object(h.c)("batalpenjualan/get/by-kode-barcode/"+a).then(a=>{if(0===a.data.length)Object(p.e)("info","Kode Barcode Yang Anda Cari Tidak Ada"),this.setState({isloadingFaktur:!1});else{console.log(a.data);let e=[{no_faktur_group:"Silahkan Pilih",no_faktur_jual:"Silahkan Pilih"}];a.data.forEach((a,t)=>{e.push({no_faktur_group:a._id.no_faktur_group,no_faktur_jual:a._id.no_faktur_jual}),this.props.change("no_faktur","Silahkan Pilih"),this.setState({isloadingFaktur:!1}),this.props.dispatch(Object(u.p)(e))})}}).catch(a=>{this.setState({isloadingFaktur:!1}),Object(p.e)("info","Kode Barcode Yang Anda Cari Tidak Ada")})},1500)}getDetailFaktur(){this.setState({isLoading:!0});let a={no_faktur_group:this.state.no_faktur_group_selected};Object(h.e)("batalpenjualan/get/by-faktur",a).then(a=>{0===a.data.length?(Object(p.e)("info","Data Transaksi Tersbut Tidak Ada"),this.setState({isLoading:!1})):(this.props.dispatch(Object(u.o)(a.data)),this.setState({isLoading:!1}))}).catch(a=>{Object(p.e)("info","Data Transaksi Tersbut Tidak Ada"),this.setState({isLoading:!1})})}componentDidMount(){this.props.dispatch(Object(d.nb)()),setTimeout(()=>{document.getElementById("kode_barcode").focus()},100)}btlPenjualan(){this.setState({isLoadingBatal:!0}),setTimeout(()=>{this.props.dispatch(Object(r.d)("HeadBatalPenjualan")),this.setState({isLoadingBatal:!1,no_faktur_group_selected:""}),Object(m.p)("data_barang_batal_jual",[]),this.props.dispatch(Object(u.p)([])),this.props.dispatch(Object(u.o)([]))},500)}render(){return s.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-4"},s.a.createElement(_.a,{id:"kode_barcode",name:"kode_barcode",component:f.e,type:"text",label:"Kode Barcode",placeholder:"Masukan Kode Barcode"})),s.a.createElement("div",{className:"col-lg-4"},s.a.createElement(_.a,{label:"Alasan",name:"alasan",options:this.props.datakondisi.filter(a=>void 0!==a.kondisi_barang).map(a=>{return{value:a.kondisi_barang,name:a.kondisi_barang}}),placeholder:"Silahkan Pilih Alasan",component:f.f})),s.a.createElement("div",{className:"col-lg-4"},s.a.createElement("div",{className:"text-right"},s.a.createElement("label",null,"\xa0"),s.a.createElement("button",{type:"submit",name:"type_btn",className:"btn btn-primary btn-block",disabled:this.state.isLoading},this.state.isLoading?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Mencari"):"Cari Data"))),s.a.createElement("div",{className:"col-lg-12"},s.a.createElement(j.a,{keyField:"kode_barcode",exportCsv:!1,data:0===Object(m.l)("data_barang_batal_jual").length?[]:JSON.parse(Object(m.l)("data_barang_batal_jual")),columns:this.props.columns,empty:!0,textEmpty:"Data Barang Kosong"})),s.a.createElement("div",{className:"col-lg-12"},s.a.createElement("label",null,"\xa0"),s.a.createElement("button",{type:"button",onClick:()=>this.props.simpanBatal(),name:"type_btn",className:"btn btn-primary",disabled:this.props.isLoading},this.props.isLoading?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0Simpan Batal Penjualan"):"Simpan Batal Penjualan"),"\xa0",s.a.createElement("button",{type:"button",name:"type_btn",onClick:()=>this.btlPenjualan(),className:"btn btn-warning",disabled:this.state.isLoadingBatal},this.state.isLoadingBatal?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Batal"):"Batal"))),this.state.isLoading?s.a.createElement(S.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}B=Object(k.a)({form:"HeadBatalPenjualan",enableReinitialize:!0,validate:E.a})(B);var N=Object(i.b)(a=>({no_faktur:a.penjualan.setNoFakturPenjualan,setBatalPenjualan:a.penjualan.setBatalPenjualan,datakondisi:a.datamaster.getDataKondisiBarang}),null)(B);class L extends n.Component{constructor(a){super(a),this.state={}}componentDidMount(){setTimeout(()=>{document.getElementById("username").focus()},100)}render(){return s.a.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:a=>{"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-6"},s.a.createElement(_.a,{name:"no_faktur_group",component:f.b,type:"hidden"}),s.a.createElement(_.a,{name:"alasan",component:f.b,type:"hidden"}),s.a.createElement(_.a,{id:"username",name:"username",component:f.e,type:"text",label:"Username",placeholder:"Masukan Username"})),s.a.createElement("div",{className:"col-lg-6"},s.a.createElement(_.a,{name:"password",component:f.e,type:"password",label:"Password",placeholder:"Masukan Password"})),s.a.createElement("div",{className:"col-lg-12"},s.a.createElement(_.a,{name:"keterangan",component:f.e,label:"Keterangan",placeholder:"Masukan Keterangan"})),s.a.createElement("div",{className:"col-lg-12"},s.a.createElement("label",null," \xa0 "),s.a.createElement("button",{type:"submit",name:"type_btn",className:"btn btn-primary btn-block",disabled:this.props.isLoadingOtorisasi},this.props.isLoadingOtorisasi?s.a.createElement(s.a.Fragment,null,s.a.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Simpan"):"Simpan"))),this.props.isLoadingOtorisasi?s.a.createElement(S.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}L=Object(k.a)({form:"OtorisasiBatalJual",enableReinitialize:!0})(L);var y=Object(i.b)(null)(L);e.default=Object(i.b)(a=>({setBatalPenjualan:a.penjualan.setBatalPenjualan}),null)(class extends s.a.Component{constructor(a){super(a),this.state={isLoading:!1,databarang:[],isLoadingOtorisasi:!1,columns:[{dataField:"no_faktur_jual",text:"No Faktur",footer:"Total Barang "},{dataField:"kode_barcode",text:"Kode Barcode",footer:""},{dataField:"nama_barang",text:"Nama Barang",footer:""},{dataField:"berat",text:"Berat",formatter:a=>s.a.createElement("span",null,parseInt(a).toFixed(1)),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toFixed(1)},{dataField:"harga_jual",text:"Harga Jual",formatter:a=>s.a.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"harga_total",text:"Harga Total",formatter:a=>s.a.createElement("span",null,parseInt(a).toLocaleString("kr-KO")),footer:a=>parseInt(a.reduce((a,e)=>a+e,0)).toLocaleString("kr-KO")},{dataField:"alasan",text:"Alasan"},{dataField:"Aksi",text:"Aksi",csvExport:!1,headerClasses:"text-center",formatter:(a,e,t)=>s.a.createElement("div",{className:"row text-center"},s.a.createElement("div",{className:"col-12"},s.a.createElement("button",{onClick:()=>{this.hapusDataBarang(t)},className:"btn btn-danger",type:"button"},s.a.createElement("i",{className:"fa fa-trash"}))))}]},this.handleSubmit=this.handleSubmit.bind(this)}hapusDataBarang(a){c.a.fire({title:"Anda yakin ingin mengapus barang ini ? ",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(e=>{if(e.isConfirmed){let e=Object(m.g)("data_barang_batal_jual");e.splice(a,1),Object(m.p)("data_barang_batal_jual",e),this.setState({status:"berhasil"})}})}handleSubmit(a){Object(h.c)("batalpenjualan/get/by-kode-barcode/"+a.kode_barcode).then(e=>{0===e.data.length?(Object(p.e)("info","Kode Barcode Yang Anda Cari Tidak Ada"),this.setState({isloadingFaktur:!1})):e.data.forEach(e=>{let t={alasan:a.alasan,kode_barcode:e.kode_barcode,no_faktur_group:e.no_faktur_group,no_faktur_jual:e.no_faktur_jual,nama_barang:e.nama_barang,berat:e.berat,harga_jual:e.harga_jual,harga_total:e.harga_total,harga_atribut:e.harga_atribut,nama_atribut:e.nama_atribut,ongkos:e.ongkos},n=0===Object(m.l)("data_barang_batal_jual").length?[]:JSON.parse(Object(m.l)("data_barang_batal_jual"));if(0===n.length)return n.push(t),Object(m.m)("data_barang_batal_jual",JSON.stringify(n)),this.setState({status:"berhasil"}),!1;-1===n.findIndex(a=>a.kode_barcode===e.kode_barcode)?-1===n.findIndex(a=>a.no_faktur_group===e.no_faktur_group)?Object(p.e)("info","No Faktur Tidak Sama"):(n.push(t),Object(m.m)("data_barang_batal_jual",JSON.stringify(n))):Object(p.e)("info","Kode Barcode Sudah Ada Di Tabel"),this.setState({status:"berhasil"})})}).catch(a=>{this.setState({isloadingFaktur:!1}),Object(p.e)("info","Kode Barcode Yang Anda Cari Tidak Ada")})}simpanTransaksiJual(a){this.setState({isLoadingOtorisasi:!0});let e=Object(m.g)("data_barang_batal_jual"),t=[];e.forEach(a=>{let e={no_faktur_group:a.no_faktur_group,no_faktur_jual:a.no_faktur_jual,alasan:a.alasan};t.push(e)});let n={user_id:a.username,password:a.password,kategori:"BATAL PENJUALAN",description:"SIMPAN BATAL PENJUALAN",keterangan:a.keterangan.toUpperCase()||"-"};Object(h.f)("authorization",n).then(a=>{Object(p.e)("success","Otorisasi Berhasil"),this.setState({isLoadingOtorisasi:!0}),Object(h.e)("batalpenjualan/simpan",t).then(a=>{this.setState({isLoadingOtorisasi:!1}),this.props.dispatch(Object(u.o)([])),this.props.dispatch(Object(u.p)([])),Object(p.e)("success",a.data.message)}).then(()=>{this.props.dispatch(Object(r.d)("HeadBatalPenjualan")),this.props.dispatch(Object(r.d)("OtorisasiBatalJual")),Object(m.p)("data_barang_batal_jual",[]),this.setState({isLoadingOtorisasi:!1}),this.props.dispatch(Object(d.wb)())}).catch(a=>{this.setState({isLoadingOtorisasi:!1}),Object(p.e)("info","Error menyimpan data, Silahkan Cek tanggal transaksi dan koneksi anda")})}).catch(a=>{Object(p.e)("info","Username atau Password Salah"),this.setState({isLoadingOtorisasi:!1})})}simpanBatal(){this.props.dispatch(Object(d.xb)())}render(){return s.a.createElement("div",null,s.a.createElement("ol",{className:"breadcrumb float-xl-right"},s.a.createElement("li",{className:"breadcrumb-item"},s.a.createElement(l.b,{to:"#"},"Penjualan")),s.a.createElement("li",{className:"breadcrumb-item active"},"Batal Penjualan")),s.a.createElement("h1",{className:"page-header"},"Batal Penjualan "),s.a.createElement(g.a,null,s.a.createElement(g.c,null,"Batal Penjualan"),s.a.createElement("br",null),s.a.createElement("div",{className:"container"},s.a.createElement(N,{isLoading:this.state.isLoading,onSubmit:a=>this.handleSubmit(a),data:this.state.databarang,columns:this.state.columns,simpanBatal:()=>this.simpanBatal()})),s.a.createElement("br",null),s.a.createElement(b.a,{size:"L",title:"Otorisasi Pembatalan",content:s.a.createElement(y,{isLoadingOtorisasi:this.state.isLoadingOtorisasi,onSubmit:a=>this.simpanTransaksiJual(a)})})))}})},725:function(a,e,t){"use strict";e.a=(a=>{const e={};return a.alasan||(e.alasan="Alasan Harus Diisi"),e})}}]);
//# sourceMappingURL=14.ede0c195.chunk.js.map